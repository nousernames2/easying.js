(function(r,h){typeof exports=="object"&&typeof module<"u"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):(r=typeof globalThis<"u"?globalThis:r||self,h((r.Easying=r.Easying||{},r.Easying.js={})))})(this,(function(r){"use strict";class h{FPS;curFrames={};animations={};receivers={};currentPositions=[];elementRestingPositions=[];paused=!1;constructor(){this.FPS=60,this.calcFps(),document.addEventListener("visibilitychange",()=>{this.paused=document.visibilityState!=="visible"})}async calcFps(){const e=performance.now(),i=await this.waitForFrame(),s=1e3/(e-i);s<30?this.FPS=24:s<60?this.FPS=30:this.FPS=60}async waitForTimedFrame(t){const a=(1e3/this.FPS-t)/1e3;a>0&&await this.waitForTime(a)}async stutterDetection(t){const i=1e3/this.FPS;t>i&&(this.FPS===30?this.FPS=24:this.FPS-=10)}async waitForFrame(){return new Promise(t=>requestAnimationFrame(t))}async waitForTime(t){await new Promise(e=>setTimeout(e,t*1e3))}async delay(t){await this.waitForTime(t)}init(t,e,i){const s=typeof t=="function";let a;return i?a=i:a=window.crypto.randomUUID(),this.currentPositions.every(([o])=>o!==t)&&this.currentPositions.push([s?a:t,{}]),this.curFrames[a]=0,this.animations[a]=e,this.receivers[a]=t,this.animate.bind(this,a)}initMany(t,e){let i=[];for(let s=0;s<t.length;s++){const a=window.crypto.randomUUID();this.currentPositions.every(([o])=>o!==t[s])&&this.currentPositions.push([t[s],{}]),this.curFrames[a]=0,this.animations[a]=e,this.receivers[a]=t[s],i.push(this.animate.bind(this,a))}return i}async generateFrames(t,e){const i=this.animations[e],s=i.seconds*this.FPS;for(await this.waitForTime(i.delay??0);this.curFrames[e]<=s;)if(this.paused)await this.waitForFrame();else{const a=performance.now();this.calcFrame(t,e);const o=performance.now();this.stutterDetection(o-a),await this.waitForTimedFrame(o-a)}}calcFrame(t,e){const i=this.animations[e],s=i.seconds*this.FPS,a=i.ease;Object.entries(i.parameters).forEach(([d,l])=>{if(!l)return;const{start:u}=l,{end:c}=l,f=c-u,m=a(this.curFrames[e],u,f,s),I=d;let P;typeof t=="function"?P=this.getTuple(e,this.currentPositions):P=this.getTuple(t,this.currentPositions),P&&(P[1]={...P[1],[I]:m})}),this.drawFrame(t,e),this.curFrames[e]++}drawFrame(t,e){let i;if(typeof t=="function"?i=this.getTuple(e,this.currentPositions):i=this.getTuple(t,this.currentPositions),typeof t=="function"){i&&t(i[1]);return}if(!i)return;let s=[];s=Object.entries(i[1]);const a=[];let o=s.map(([u,c])=>{if(!c)return;const f=u;return f==="translateX"||f==="translateY"||f==="rotate"||f==="scale"?{p:f,value:c}:(a.push({p:f,value:c}),!1)}).filter(Boolean);const d=o.filter(u=>u.p==="translateX"||u.p==="translateY"),l=o.filter(u=>u.p!=="translateX"&&u.p!=="translateY");o=[...d,...l],o.forEach(({p:u,value:c},f)=>{const m=u==="translateX"||u==="translateY"?"px":u==="rotate"?"deg":u==="scale"?"":"default",I=m==="px"?Math.round(c):c;f===0?t.style.transform=`${u}(${I}${m})`:t.style.transform+=` ${u}(${I}${m})`}),a.forEach(({p:u,value:c})=>{u==="opacity"?t.style[u]=`${c}`:t.style[u]=`${c}px`})}async animate(t){const e=this.receivers[t];let i,s;return typeof e=="function"?(i=this.getTuple(t,this.elementRestingPositions),s=this.getTuple(t,this.currentPositions)):(i=this.getTuple(e,this.elementRestingPositions),s=this.getTuple(e,this.currentPositions)),s&&i&&(s[1]={...s[1],...i[1]}),await this.generateFrames(e,t),typeof e=="function"?this.updateRestingPositions(t):this.updateRestingPositions(e),this.curFrames[t]=0,this.animations[t].destroyOnComplete&&this.destroy(t,e),this}updateRestingPositions(t){const e=this.getTuple(t,this.currentPositions);if(e&&typeof t!="function"){let i=!1;this.elementRestingPositions=this.elementRestingPositions.map(s=>{const[a,o]=s;return a===t?(i=!0,[t,{...o,...e[1]}]):s}),i||this.elementRestingPositions.push([t,e[1]])}}getTuple(t,e){let i;return typeof t!="function"?i=e.find(([s])=>s===t):i=e.find(([s])=>s===t),i||null}destroy(t,e){typeof e=="function"?(this.elementRestingPositions=this.elementRestingPositions.filter(([i])=>i!==t),this.currentPositions=this.currentPositions.filter(([i])=>i!==t)):(this.elementRestingPositions=this.elementRestingPositions.filter(([i])=>i!==e),this.currentPositions=this.currentPositions.filter(([i])=>i!==e)),delete this.curFrames[t],delete this.animations[t],delete this.receivers[t]}}function p(...n){return()=>Promise.all(n.map(t=>t()))}function w(...n){return async t=>{let e=0;for(;e<n.length;)n[e](),await O(t),e++}}function O(n){return new Promise(t=>setTimeout(t,n*1e3))}function M(...n){return async()=>{for(let t=0;t<n.length;t++)await n[t]()}}function y(n){return()=>{let t=!1;const e=async i=>{t||(await i(),e(i))};return e(n),{kill:()=>t=!0}}}function S(n){n.style={}}const E=function(n,t,e,i){return e*(n/=i)+t},v=function(n,t,e,i){return e*(n/=i)*n+t},C=function(n,t,e,i){return-e*(n/=i)*(n-2)+t},T=function(n,t,e,i){return(n/=i/2)<1?e/2*n*n+t:-e/2*(--n*(n-2)-1)+t},Q=function(n,t,e,i){return e*(n/=i)*n*n+t},R=function(n,t,e,i){return e*((n=n/i-1)*n*n+1)+t},B=function(n,t,e,i){return(n/=i/2)<1?e/2*n*n*n+t:e/2*((n-=2)*n*n+2)+t},$=function(n,t,e,i){return e*(n/=i)*n*n*n+t},j=function(n,t,e,i){return-e*((n=n/i-1)*n*n*n-1)+t},q=function(n,t,e,i){return(n/=i/2)<1?e/2*n*n*n*n+t:-e/2*((n-=2)*n*n*n-2)+t},D=function(n,t,e,i){return e*(n/=i)*n*n*n*n+t},U=function(n,t,e,i){return e*((n=n/i-1)*n*n*n*n+1)+t},X=function(n,t,e,i){return(n/=i/2)<1?e/2*n*n*n*n*n+t:e/2*((n-=2)*n*n*n*n+2)+t},Y=function(n,t,e,i){return-e*Math.cos(n/i*(Math.PI/2))+e+t},L=function(n,t,e,i){return e*Math.sin(n/i*(Math.PI/2))+t},A=function(n,t,e,i){return-e/2*(Math.cos(Math.PI*n/i)-1)+t},z=function(n,t,e,i){return n==0?t:e*Math.pow(2,10*(n/i-1))+t},G=function(n,t,e,i){return n==i?t+e:e*(-Math.pow(2,-10*n/i)+1)+t},H=function(n,t,e,i){return n==0?t:n==i?t+e:(n/=i/2)<1?e/2*Math.pow(2,10*(n-1))+t:e/2*(-Math.pow(2,-10*--n)+2)+t},J=function(n,t,e,i){return-e*(Math.sqrt(1-(n/=i)*n)-1)+t},N=function(n,t,e,i){return e*Math.sqrt(1-(n=n/i-1)*n)+t},V=function(n,t,e,i){return(n/=i/2)<1?-e/2*(Math.sqrt(1-n*n)-1)+t:e/2*(Math.sqrt(1-(n-=2)*n)+1)+t},W=function(n,t,e,i){var o=1.70158,s=0,a=e;if(n==0)return t;if((n/=i)==1)return t+e;if(s||(s=i*.3),a<Math.abs(e)){a=e;var o=s/4}else var o=s/(2*Math.PI)*Math.asin(e/a);return-(a*Math.pow(2,10*(n-=1))*Math.sin((n*i-o)*(2*Math.PI)/s))+t},Z=function(n,t,e,i){var o=1.70158,s=0,a=e;if(n==0)return t;if((n/=i)==1)return t+e;if(s||(s=i*.3),a<Math.abs(e)){a=e;var o=s/4}else var o=s/(2*Math.PI)*Math.asin(e/a);return a*Math.pow(2,-10*n)*Math.sin((n*i-o)*(2*Math.PI)/s)+e+t},_=function(n,t,e,i){var o=1.70158,s=0,a=e;if(n==0)return t;if((n/=i/2)==2)return t+e;if(s||(s=i*(.3*1.5)),a<Math.abs(e)){a=e;var o=s/4}else var o=s/(2*Math.PI)*Math.asin(e/a);return n<1?-.5*(a*Math.pow(2,10*(n-=1))*Math.sin((n*i-o)*(2*Math.PI)/s))+t:a*Math.pow(2,-10*(n-=1))*Math.sin((n*i-o)*(2*Math.PI)/s)*.5+e+t},K=function(n,t,e,i){let s=1.70158;return e*(n/=i)*n*((s+1)*n-s)+t},b=function(n,t,e,i){let s=1.70158;return e*((n=n/i-1)*n*((s+1)*n+s)+1)+t},k=function(n,t,e,i){let s=1.70158;return(n/=i/2)<1?e/2*(n*n*(((s*=1.525)+1)*n-s))+t:e/2*((n-=2)*n*(((s*=1.525)+1)*n+s)+2)+t},g=function(n,t,e,i){return e-F(i-n,0,e,i)+t},F=function(n,t,e,i){return(n/=i)<1/2.75?e*(7.5625*n*n)+t:n<2/2.75?e*(7.5625*(n-=1.5/2.75)*n+.75)+t:n<2.5/2.75?e*(7.5625*(n-=2.25/2.75)*n+.9375)+t:e*(7.5625*(n-=2.625/2.75)*n+.984375)+t},x=function(n,t,e,i){return n<i/2?g(n*2,0,e,i)*.5+t:F(n*2-i,0,e,i)*.5+e*.5+t};r.Consecutive=M,r.Easying=h,r.Loop=y,r.Reset=S,r.Staggered=w,r.Synchronised=p,r.easeInBack=K,r.easeInBounce=g,r.easeInCirc=J,r.easeInCubic=Q,r.easeInElastic=W,r.easeInExpo=z,r.easeInOutBack=k,r.easeInOutBounce=x,r.easeInOutCirc=V,r.easeInOutCubic=B,r.easeInOutElastic=_,r.easeInOutExpo=H,r.easeInOutQuad=T,r.easeInOutQuart=q,r.easeInOutQuint=X,r.easeInOutSine=A,r.easeInQuad=v,r.easeInQuart=$,r.easeInQuint=D,r.easeInSine=Y,r.easeOutBack=b,r.easeOutBounce=F,r.easeOutCirc=N,r.easeOutCubic=R,r.easeOutElastic=Z,r.easeOutExpo=G,r.easeOutQuad=C,r.easeOutQuart=j,r.easeOutQuint=U,r.easeOutSine=L,r.linear=E,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
